\documentclass{article}\usepackage[]{graphicx}\usepackage[]{xcolor}
% maxwidth is the original width if it is less than linewidth
% otherwise use linewidth (to make sure the graphics do not exceed the margin)
\makeatletter
\def\maxwidth{ %
  \ifdim\Gin@nat@width>\linewidth
    \linewidth
  \else
    \Gin@nat@width
  \fi
}
\makeatother

\definecolor{fgcolor}{rgb}{0.345, 0.345, 0.345}
\newcommand{\hlnum}[1]{\textcolor[rgb]{0.686,0.059,0.569}{#1}}%
\newcommand{\hlstr}[1]{\textcolor[rgb]{0.192,0.494,0.8}{#1}}%
\newcommand{\hlcom}[1]{\textcolor[rgb]{0.678,0.584,0.686}{\textit{#1}}}%
\newcommand{\hlopt}[1]{\textcolor[rgb]{0,0,0}{#1}}%
\newcommand{\hlstd}[1]{\textcolor[rgb]{0.345,0.345,0.345}{#1}}%
\newcommand{\hlkwa}[1]{\textcolor[rgb]{0.161,0.373,0.58}{\textbf{#1}}}%
\newcommand{\hlkwb}[1]{\textcolor[rgb]{0.69,0.353,0.396}{#1}}%
\newcommand{\hlkwc}[1]{\textcolor[rgb]{0.333,0.667,0.333}{#1}}%
\newcommand{\hlkwd}[1]{\textcolor[rgb]{0.737,0.353,0.396}{\textbf{#1}}}%
\let\hlipl\hlkwb

\usepackage{framed}
\makeatletter
\newenvironment{kframe}{%
 \def\at@end@of@kframe{}%
 \ifinner\ifhmode%
  \def\at@end@of@kframe{\end{minipage}}%
  \begin{minipage}{\columnwidth}%
 \fi\fi%
 \def\FrameCommand##1{\hskip\@totalleftmargin \hskip-\fboxsep
 \colorbox{shadecolor}{##1}\hskip-\fboxsep
     % There is no \\@totalrightmargin, so:
     \hskip-\linewidth \hskip-\@totalleftmargin \hskip\columnwidth}%
 \MakeFramed {\advance\hsize-\width
   \@totalleftmargin\z@ \linewidth\hsize
   \@setminipage}}%
 {\par\unskip\endMakeFramed%
 \at@end@of@kframe}
\makeatother

\definecolor{shadecolor}{rgb}{.97, .97, .97}
\definecolor{messagecolor}{rgb}{0, 0, 0}
\definecolor{warningcolor}{rgb}{1, 0, 1}
\definecolor{errorcolor}{rgb}{1, 0, 0}
\newenvironment{knitrout}{}{} % an empty environment to be redefined in TeX

\usepackage{alltt}
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\begin{document}

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlcom{# Groundwater U-238 Contamination Mapping and Contouring}
\hlcom{# Auto-install and load required packages}
\hlstd{required_packages} \hlkwb{<-} \hlkwd{c}\hlstd{(}\hlstr{"gstat"}\hlstd{,} \hlstr{"sp"}\hlstd{,} \hlstr{"ggplot2"}\hlstd{,} \hlstr{"viridis"}\hlstd{,} \hlstr{"gridExtra"}\hlstd{,} \hlstr{"fields"}\hlstd{)}

\hlkwa{for} \hlstd{(pkg} \hlkwa{in} \hlstd{required_packages) \{}
  \hlkwa{if} \hlstd{(}\hlopt{!}\hlkwd{require}\hlstd{(pkg,} \hlkwc{character.only} \hlstd{=} \hlnum{TRUE}\hlstd{,} \hlkwc{quietly} \hlstd{=} \hlnum{TRUE}\hlstd{)) \{}
    \hlkwd{install.packages}\hlstd{(pkg,} \hlkwc{dependencies} \hlstd{=} \hlnum{TRUE}\hlstd{)}
    \hlkwd{library}\hlstd{(pkg,} \hlkwc{character.only} \hlstd{=} \hlnum{TRUE}\hlstd{)}
  \hlstd{\}}
\hlstd{\}}
\end{alltt}


{\ttfamily\noindent\itshape\color{messagecolor}{\#\# Spam version 2.10-0 (2023-10-23) is loaded.\\\#\# Type 'help( Spam)' or 'demo( spam)' for a short introduction \\\#\# and overview of this package.\\\#\# Help for individual functions is also obtained by adding the\\\#\# suffix '.spam' to the function name, e.g. 'help( chol.spam)'.}}

{\ttfamily\noindent\itshape\color{messagecolor}{\#\# \\\#\# Attaching package: 'spam'}}

{\ttfamily\noindent\itshape\color{messagecolor}{\#\# The following objects are masked from 'package:base':\\\#\# \\\#\# \ \ \ \ backsolve, forwardsolve}}

{\ttfamily\noindent\itshape\color{messagecolor}{\#\# \\\#\# Try help(fields) to get started.}}\begin{alltt}
\hlcom{# Set seed for reproducibility}
\hlkwd{set.seed}\hlstd{(}\hlnum{123}\hlstd{)}

\hlcom{# 1. Generate simulated sampling points (monitoring wells)}
\hlstd{n_samples} \hlkwb{<-} \hlnum{30}
\hlstd{x} \hlkwb{<-} \hlkwd{runif}\hlstd{(n_samples,} \hlnum{0}\hlstd{,} \hlnum{100}\hlstd{)}
\hlstd{y} \hlkwb{<-} \hlkwd{runif}\hlstd{(n_samples,} \hlnum{0}\hlstd{,} \hlnum{100}\hlstd{)}

\hlcom{# Simulate U-238 concentration (µg/L) with contamination plumes}
\hlstd{hotspot1_x} \hlkwb{<-} \hlnum{30}
\hlstd{hotspot1_y} \hlkwb{<-} \hlnum{70}
\hlstd{hotspot2_x} \hlkwb{<-} \hlnum{60}
\hlstd{hotspot2_y} \hlkwb{<-} \hlnum{40}

\hlstd{u238} \hlkwb{<-} \hlnum{50} \hlopt{*} \hlkwd{exp}\hlstd{(}\hlopt{-}\hlstd{((x} \hlopt{-} \hlstd{hotspot1_x)}\hlopt{^}\hlnum{2} \hlopt{+} \hlstd{(y} \hlopt{-} \hlstd{hotspot1_y)}\hlopt{^}\hlnum{2}\hlstd{)} \hlopt{/} \hlnum{500}\hlstd{)} \hlopt{+}
  \hlnum{30} \hlopt{*} \hlkwd{exp}\hlstd{(}\hlopt{-}\hlstd{((x} \hlopt{-} \hlstd{hotspot2_x)}\hlopt{^}\hlnum{2} \hlopt{+} \hlstd{(y} \hlopt{-} \hlstd{hotspot2_y)}\hlopt{^}\hlnum{2}\hlstd{)} \hlopt{/} \hlnum{300}\hlstd{)} \hlopt{+}
  \hlkwd{rnorm}\hlstd{(n_samples,} \hlnum{0}\hlstd{,} \hlnum{2}\hlstd{)}

\hlstd{u238} \hlkwb{<-} \hlkwd{pmax}\hlstd{(u238,} \hlnum{0.1}\hlstd{)}  \hlcom{# No negative values}

\hlcom{# Create data frame}
\hlstd{contamination_data} \hlkwb{<-} \hlkwd{data.frame}\hlstd{(}\hlkwc{x} \hlstd{= x,} \hlkwc{y} \hlstd{= y,} \hlkwc{u238} \hlstd{= u238)}

\hlkwd{cat}\hlstd{(}\hlstr{"Sample Data Summary:\textbackslash{}n"}\hlstd{)}
\end{alltt}
\begin{verbatim}
## Sample Data Summary:
\end{verbatim}
\begin{alltt}
\hlkwd{print}\hlstd{(}\hlkwd{summary}\hlstd{(contamination_data))}
\end{alltt}
\begin{verbatim}
##        x                y               u238        
##  Min.   : 4.206   Min.   : 2.461   Min.   : 0.1000  
##  1st Qu.:34.818   1st Qu.:20.900   1st Qu.: 0.8132  
##  Median :58.339   Median :39.409   Median : 4.1629  
##  Mean   :57.240   Mean   :43.864   Mean   : 9.5974  
##  3rd Qu.:85.934   3rd Qu.:73.766   3rd Qu.:16.8782  
##  Max.   :99.427   Max.   :96.302   Max.   :41.6827
\end{verbatim}
\begin{alltt}
\hlkwd{cat}\hlstd{(}\hlstr{"\textbackslash{}n"}\hlstd{)}
\end{alltt}
\end{kframe}
\begin{kframe}\begin{alltt}
\hlcom{# 2. Create 50x50 grid for interpolation}
\hlstd{grid_x} \hlkwb{<-} \hlkwd{seq}\hlstd{(}\hlnum{0}\hlstd{,} \hlnum{100}\hlstd{,} \hlkwc{length.out} \hlstd{=} \hlnum{50}\hlstd{)}
\hlstd{grid_y} \hlkwb{<-} \hlkwd{seq}\hlstd{(}\hlnum{0}\hlstd{,} \hlnum{100}\hlstd{,} \hlkwc{length.out} \hlstd{=} \hlnum{50}\hlstd{)}
\hlstd{grid} \hlkwb{<-} \hlkwd{expand.grid}\hlstd{(}\hlkwc{x} \hlstd{= grid_x,} \hlkwc{y} \hlstd{= grid_y)}

\hlcom{# 3. Interpolation Method 1: Inverse Distance Weighting (IDW)}
\hlkwd{coordinates}\hlstd{(contamination_data)} \hlkwb{<-} \hlopt{~}\hlstd{x}\hlopt{+}\hlstd{y}
\hlkwd{coordinates}\hlstd{(grid)} \hlkwb{<-} \hlopt{~}\hlstd{x}\hlopt{+}\hlstd{y}
\hlkwd{gridded}\hlstd{(grid)} \hlkwb{<-} \hlnum{TRUE}

\hlkwd{cat}\hlstd{(}\hlstr{"Performing IDW interpolation...\textbackslash{}n"}\hlstd{)}
\end{alltt}
\begin{verbatim}
## Performing IDW interpolation...
\end{verbatim}
\begin{alltt}
\hlstd{idw_result} \hlkwb{<-} \hlkwd{idw}\hlstd{(u238} \hlopt{~} \hlnum{1}\hlstd{, contamination_data, grid,} \hlkwc{idp} \hlstd{=} \hlnum{2}\hlstd{)}
\end{alltt}
\begin{verbatim}
## [inverse distance weighted interpolation]
\end{verbatim}
\begin{alltt}
\hlstd{idw_df} \hlkwb{<-} \hlkwd{as.data.frame}\hlstd{(idw_result)}
\hlkwd{names}\hlstd{(idw_df)[}\hlnum{3}\hlstd{]} \hlkwb{<-} \hlstr{"u238_idw"}

\hlcom{# 4. Interpolation Method 2: Kriging}
\hlkwd{cat}\hlstd{(}\hlstr{"Fitting variogram and performing kriging...\textbackslash{}n"}\hlstd{)}
\end{alltt}
\begin{verbatim}
## Fitting variogram and performing kriging...
\end{verbatim}
\begin{alltt}
\hlstd{v} \hlkwb{<-} \hlkwd{variogram}\hlstd{(u238} \hlopt{~} \hlnum{1}\hlstd{, contamination_data)}
\hlstd{v_fit} \hlkwb{<-} \hlkwd{fit.variogram}\hlstd{(v,} \hlkwd{vgm}\hlstd{(}\hlkwc{psill} \hlstd{=} \hlnum{100}\hlstd{,} \hlkwc{model} \hlstd{=} \hlstr{"Sph"}\hlstd{,} \hlkwc{range} \hlstd{=} \hlnum{30}\hlstd{,} \hlkwc{nugget} \hlstd{=} \hlnum{1}\hlstd{))}
\end{alltt}


{\ttfamily\noindent\color{warningcolor}{\#\# Warning in fit.variogram(v, vgm(psill = 100, model = "{}Sph"{}, range = 30, : No convergence after 200 iterations: try different initial values?}}

{\ttfamily\noindent\color{warningcolor}{\#\# Warning in fit.variogram(object, model, fit.sills = fit.sills, fit.ranges = fit.ranges, : No convergence after 200 iterations: try different initial values?}}\begin{alltt}
\hlstd{krige_result} \hlkwb{<-} \hlkwd{krige}\hlstd{(u238} \hlopt{~} \hlnum{1}\hlstd{, contamination_data, grid,} \hlkwc{model} \hlstd{= v_fit)}
\end{alltt}
\begin{verbatim}
## [using ordinary kriging]
\end{verbatim}
\begin{alltt}
\hlstd{krige_df} \hlkwb{<-} \hlkwd{as.data.frame}\hlstd{(krige_result)}
\hlkwd{names}\hlstd{(krige_df)[}\hlnum{3}\hlstd{]} \hlkwb{<-} \hlstr{"u238_krige"}

\hlcom{# 5. Interpolation Method 3: Thin Plate Spline}
\hlkwd{cat}\hlstd{(}\hlstr{"Performing thin plate spline interpolation...\textbackslash{}n"}\hlstd{)}
\end{alltt}
\begin{verbatim}
## Performing thin plate spline interpolation...
\end{verbatim}
\begin{alltt}
\hlstd{tps_fit} \hlkwb{<-} \hlkwd{Tps}\hlstd{(}\hlkwc{x} \hlstd{= contamination_data}\hlopt{@}\hlkwc{coords}\hlstd{,}
               \hlkwc{Y} \hlstd{= contamination_data}\hlopt{$}\hlstd{u238,}
               \hlkwc{lambda} \hlstd{=} \hlnum{0}\hlstd{)}

\hlstd{grid_coords} \hlkwb{<-} \hlkwd{expand.grid}\hlstd{(}\hlkwc{x} \hlstd{= grid_x,} \hlkwc{y} \hlstd{= grid_y)}
\hlstd{tps_predictions} \hlkwb{<-} \hlkwd{predict}\hlstd{(tps_fit, grid_coords)}

\hlstd{tps_df} \hlkwb{<-} \hlstd{grid_coords}
\hlstd{tps_df}\hlopt{$}\hlstd{u238_tps} \hlkwb{<-} \hlstd{tps_predictions}

\hlcom{# Convert sampling points back to regular data frame}
\hlstd{contamination_points} \hlkwb{<-} \hlkwd{as.data.frame}\hlstd{(contamination_data)}

\hlcom{# 6. Define contour levels and regulatory threshold}
\hlstd{contour_levels} \hlkwb{<-} \hlkwd{c}\hlstd{(}\hlnum{1}\hlstd{,} \hlnum{5}\hlstd{,} \hlnum{10}\hlstd{,} \hlnum{15}\hlstd{,} \hlnum{20}\hlstd{,} \hlnum{25}\hlstd{,} \hlnum{30}\hlstd{,} \hlnum{40}\hlstd{,} \hlnum{50}\hlstd{)}
\hlstd{mcl_u238} \hlkwb{<-} \hlnum{30}  \hlcom{# EPA Maximum Contaminant Level (µg/L)}

\hlkwd{cat}\hlstd{(}\hlstr{"\textbackslash{}nGenerating maps...\textbackslash{}n\textbackslash{}n"}\hlstd{)}
\end{alltt}
\begin{verbatim}
## 
## Generating maps...
\end{verbatim}
\begin{alltt}
\hlcom{# Plot 1: IDW Interpolation with Contours}
\hlstd{p1} \hlkwb{<-} \hlkwd{ggplot}\hlstd{()} \hlopt{+}
  \hlkwd{geom_tile}\hlstd{(}\hlkwc{data} \hlstd{= idw_df,} \hlkwd{aes}\hlstd{(}\hlkwc{x} \hlstd{= x,} \hlkwc{y} \hlstd{= y,} \hlkwc{fill} \hlstd{= u238_idw))} \hlopt{+}
  \hlkwd{geom_contour}\hlstd{(}\hlkwc{data} \hlstd{= idw_df,} \hlkwd{aes}\hlstd{(}\hlkwc{x} \hlstd{= x,} \hlkwc{y} \hlstd{= y,} \hlkwc{z} \hlstd{= u238_idw),}
               \hlkwc{breaks} \hlstd{= contour_levels,} \hlkwc{color} \hlstd{=} \hlstr{"white"}\hlstd{,} \hlkwc{linewidth} \hlstd{=} \hlnum{0.5}\hlstd{,} \hlkwc{alpha} \hlstd{=} \hlnum{0.7}\hlstd{)} \hlopt{+}
  \hlkwd{geom_contour}\hlstd{(}\hlkwc{data} \hlstd{= idw_df,} \hlkwd{aes}\hlstd{(}\hlkwc{x} \hlstd{= x,} \hlkwc{y} \hlstd{= y,} \hlkwc{z} \hlstd{= u238_idw),}
               \hlkwc{breaks} \hlstd{= mcl_u238,} \hlkwc{color} \hlstd{=} \hlstr{"red"}\hlstd{,} \hlkwc{linewidth} \hlstd{=} \hlnum{1.2}\hlstd{)} \hlopt{+}
  \hlkwd{geom_point}\hlstd{(}\hlkwc{data} \hlstd{= contamination_points,} \hlkwd{aes}\hlstd{(}\hlkwc{x} \hlstd{= x,} \hlkwc{y} \hlstd{= y),}
             \hlkwc{color} \hlstd{=} \hlstr{"black"}\hlstd{,} \hlkwc{size} \hlstd{=} \hlnum{2.5}\hlstd{,} \hlkwc{shape} \hlstd{=} \hlnum{21}\hlstd{,} \hlkwc{fill} \hlstd{=} \hlstr{"yellow"}\hlstd{,} \hlkwc{stroke} \hlstd{=} \hlnum{1}\hlstd{)} \hlopt{+}
  \hlkwd{scale_fill_viridis}\hlstd{(}\hlkwc{name} \hlstd{=} \hlstr{"U-238\textbackslash{}n(µg/L)"}\hlstd{,} \hlkwc{option} \hlstd{=} \hlstr{"plasma"}\hlstd{,} \hlkwc{limits} \hlstd{=} \hlkwd{c}\hlstd{(}\hlnum{0}\hlstd{,} \hlnum{60}\hlstd{))} \hlopt{+}
  \hlkwd{labs}\hlstd{(}\hlkwc{title} \hlstd{=} \hlstr{"IDW Interpolation (Inverse Distance Weighting)"}\hlstd{,}
       \hlkwc{subtitle} \hlstd{=} \hlstr{"Red contour = MCL threshold (30 µg/L) | Yellow points = sampling wells"}\hlstd{,}
       \hlkwc{x} \hlstd{=} \hlstr{"X Coordinate (m)"}\hlstd{,} \hlkwc{y} \hlstd{=} \hlstr{"Y Coordinate (m)"}\hlstd{)} \hlopt{+}
  \hlkwd{theme_minimal}\hlstd{(}\hlkwc{base_size} \hlstd{=} \hlnum{11}\hlstd{)} \hlopt{+}
  \hlkwd{theme}\hlstd{(}\hlkwc{plot.title} \hlstd{=} \hlkwd{element_text}\hlstd{(}\hlkwc{face} \hlstd{=} \hlstr{"bold"}\hlstd{))} \hlopt{+}
  \hlkwd{coord_fixed}\hlstd{()}

\hlcom{# Plot 2: Kriging with Contours}
\hlstd{p2} \hlkwb{<-} \hlkwd{ggplot}\hlstd{()} \hlopt{+}
  \hlkwd{geom_tile}\hlstd{(}\hlkwc{data} \hlstd{= krige_df,} \hlkwd{aes}\hlstd{(}\hlkwc{x} \hlstd{= x,} \hlkwc{y} \hlstd{= y,} \hlkwc{fill} \hlstd{= u238_krige))} \hlopt{+}
  \hlkwd{geom_contour}\hlstd{(}\hlkwc{data} \hlstd{= krige_df,} \hlkwd{aes}\hlstd{(}\hlkwc{x} \hlstd{= x,} \hlkwc{y} \hlstd{= y,} \hlkwc{z} \hlstd{= u238_krige),}
               \hlkwc{breaks} \hlstd{= contour_levels,} \hlkwc{color} \hlstd{=} \hlstr{"white"}\hlstd{,} \hlkwc{linewidth} \hlstd{=} \hlnum{0.5}\hlstd{,} \hlkwc{alpha} \hlstd{=} \hlnum{0.7}\hlstd{)} \hlopt{+}
  \hlkwd{geom_contour}\hlstd{(}\hlkwc{data} \hlstd{= krige_df,} \hlkwd{aes}\hlstd{(}\hlkwc{x} \hlstd{= x,} \hlkwc{y} \hlstd{= y,} \hlkwc{z} \hlstd{= u238_krige),}
               \hlkwc{breaks} \hlstd{= mcl_u238,} \hlkwc{color} \hlstd{=} \hlstr{"red"}\hlstd{,} \hlkwc{linewidth} \hlstd{=} \hlnum{1.2}\hlstd{)} \hlopt{+}
  \hlkwd{geom_point}\hlstd{(}\hlkwc{data} \hlstd{= contamination_points,} \hlkwd{aes}\hlstd{(}\hlkwc{x} \hlstd{= x,} \hlkwc{y} \hlstd{= y),}
             \hlkwc{color} \hlstd{=} \hlstr{"black"}\hlstd{,} \hlkwc{size} \hlstd{=} \hlnum{2.5}\hlstd{,} \hlkwc{shape} \hlstd{=} \hlnum{21}\hlstd{,} \hlkwc{fill} \hlstd{=} \hlstr{"yellow"}\hlstd{,} \hlkwc{stroke} \hlstd{=} \hlnum{1}\hlstd{)} \hlopt{+}
  \hlkwd{scale_fill_viridis}\hlstd{(}\hlkwc{name} \hlstd{=} \hlstr{"U-238\textbackslash{}n(µg/L)"}\hlstd{,} \hlkwc{option} \hlstd{=} \hlstr{"plasma"}\hlstd{,} \hlkwc{limits} \hlstd{=} \hlkwd{c}\hlstd{(}\hlnum{0}\hlstd{,} \hlnum{60}\hlstd{))} \hlopt{+}
  \hlkwd{labs}\hlstd{(}\hlkwc{title} \hlstd{=} \hlstr{"Kriging Interpolation (Geostatistical)"}\hlstd{,}
       \hlkwc{subtitle} \hlstd{=} \hlstr{"Red contour = MCL threshold (30 µg/L) | Yellow points = sampling wells"}\hlstd{,}
       \hlkwc{x} \hlstd{=} \hlstr{"X Coordinate (m)"}\hlstd{,} \hlkwc{y} \hlstd{=} \hlstr{"Y Coordinate (m)"}\hlstd{)} \hlopt{+}
  \hlkwd{theme_minimal}\hlstd{(}\hlkwc{base_size} \hlstd{=} \hlnum{11}\hlstd{)} \hlopt{+}
  \hlkwd{theme}\hlstd{(}\hlkwc{plot.title} \hlstd{=} \hlkwd{element_text}\hlstd{(}\hlkwc{face} \hlstd{=} \hlstr{"bold"}\hlstd{))} \hlopt{+}
  \hlkwd{coord_fixed}\hlstd{()}

\hlcom{# Plot 3: Thin Plate Spline with Contours}
\hlstd{p3} \hlkwb{<-} \hlkwd{ggplot}\hlstd{()} \hlopt{+}
  \hlkwd{geom_tile}\hlstd{(}\hlkwc{data} \hlstd{= tps_df,} \hlkwd{aes}\hlstd{(}\hlkwc{x} \hlstd{= x,} \hlkwc{y} \hlstd{= y,} \hlkwc{fill} \hlstd{= u238_tps))} \hlopt{+}
  \hlkwd{geom_contour}\hlstd{(}\hlkwc{data} \hlstd{= tps_df,} \hlkwd{aes}\hlstd{(}\hlkwc{x} \hlstd{= x,} \hlkwc{y} \hlstd{= y,} \hlkwc{z} \hlstd{= u238_tps),}
               \hlkwc{breaks} \hlstd{= contour_levels,} \hlkwc{color} \hlstd{=} \hlstr{"white"}\hlstd{,} \hlkwc{linewidth} \hlstd{=} \hlnum{0.5}\hlstd{,} \hlkwc{alpha} \hlstd{=} \hlnum{0.7}\hlstd{)} \hlopt{+}
  \hlkwd{geom_contour}\hlstd{(}\hlkwc{data} \hlstd{= tps_df,} \hlkwd{aes}\hlstd{(}\hlkwc{x} \hlstd{= x,} \hlkwc{y} \hlstd{= y,} \hlkwc{z} \hlstd{= u238_tps),}
               \hlkwc{breaks} \hlstd{= mcl_u238,} \hlkwc{color} \hlstd{=} \hlstr{"red"}\hlstd{,} \hlkwc{linewidth} \hlstd{=} \hlnum{1.2}\hlstd{)} \hlopt{+}
  \hlkwd{geom_point}\hlstd{(}\hlkwc{data} \hlstd{= contamination_points,} \hlkwd{aes}\hlstd{(}\hlkwc{x} \hlstd{= x,} \hlkwc{y} \hlstd{= y),}
             \hlkwc{color} \hlstd{=} \hlstr{"black"}\hlstd{,} \hlkwc{size} \hlstd{=} \hlnum{2.5}\hlstd{,} \hlkwc{shape} \hlstd{=} \hlnum{21}\hlstd{,} \hlkwc{fill} \hlstd{=} \hlstr{"yellow"}\hlstd{,} \hlkwc{stroke} \hlstd{=} \hlnum{1}\hlstd{)} \hlopt{+}
  \hlkwd{scale_fill_viridis}\hlstd{(}\hlkwc{name} \hlstd{=} \hlstr{"U-238\textbackslash{}n(µg/L)"}\hlstd{,} \hlkwc{option} \hlstd{=} \hlstr{"plasma"}\hlstd{,} \hlkwc{limits} \hlstd{=} \hlkwd{c}\hlstd{(}\hlnum{0}\hlstd{,} \hlnum{60}\hlstd{))} \hlopt{+}
  \hlkwd{labs}\hlstd{(}\hlkwc{title} \hlstd{=} \hlstr{"Thin Plate Spline Interpolation"}\hlstd{,}
       \hlkwc{subtitle} \hlstd{=} \hlstr{"Red contour = MCL threshold (30 µg/L) | Yellow points = sampling wells"}\hlstd{,}
       \hlkwc{x} \hlstd{=} \hlstr{"X Coordinate (m)"}\hlstd{,} \hlkwc{y} \hlstd{=} \hlstr{"Y Coordinate (m)"}\hlstd{)} \hlopt{+}
  \hlkwd{theme_minimal}\hlstd{(}\hlkwc{base_size} \hlstd{=} \hlnum{11}\hlstd{)} \hlopt{+}
  \hlkwd{theme}\hlstd{(}\hlkwc{plot.title} \hlstd{=} \hlkwd{element_text}\hlstd{(}\hlkwc{face} \hlstd{=} \hlstr{"bold"}\hlstd{))} \hlopt{+}
  \hlkwd{coord_fixed}\hlstd{()}

\hlcom{# Plot 4: Comparison - Contours Only (All Methods Overlaid)}
\hlstd{p4} \hlkwb{<-} \hlkwd{ggplot}\hlstd{()} \hlopt{+}
  \hlkwd{geom_contour}\hlstd{(}\hlkwc{data} \hlstd{= idw_df,} \hlkwd{aes}\hlstd{(}\hlkwc{x} \hlstd{= x,} \hlkwc{y} \hlstd{= y,} \hlkwc{z} \hlstd{= u238_idw,} \hlkwc{color} \hlstd{=} \hlstr{"IDW"}\hlstd{),}
               \hlkwc{breaks} \hlstd{= contour_levels,} \hlkwc{linewidth} \hlstd{=} \hlnum{0.8}\hlstd{)} \hlopt{+}
  \hlkwd{geom_contour}\hlstd{(}\hlkwc{data} \hlstd{= krige_df,} \hlkwd{aes}\hlstd{(}\hlkwc{x} \hlstd{= x,} \hlkwc{y} \hlstd{= y,} \hlkwc{z} \hlstd{= u238_krige,} \hlkwc{color} \hlstd{=} \hlstr{"Kriging"}\hlstd{),}
               \hlkwc{breaks} \hlstd{= contour_levels,} \hlkwc{linewidth} \hlstd{=} \hlnum{0.8}\hlstd{,} \hlkwc{linetype} \hlstd{=} \hlstr{"dashed"}\hlstd{)} \hlopt{+}
  \hlkwd{geom_contour}\hlstd{(}\hlkwc{data} \hlstd{= tps_df,} \hlkwd{aes}\hlstd{(}\hlkwc{x} \hlstd{= x,} \hlkwc{y} \hlstd{= y,} \hlkwc{z} \hlstd{= u238_tps,} \hlkwc{color} \hlstd{=} \hlstr{"TPS"}\hlstd{),}
               \hlkwc{breaks} \hlstd{= contour_levels,} \hlkwc{linewidth} \hlstd{=} \hlnum{0.8}\hlstd{,} \hlkwc{linetype} \hlstd{=} \hlstr{"dotted"}\hlstd{)} \hlopt{+}
  \hlkwd{geom_point}\hlstd{(}\hlkwc{data} \hlstd{= contamination_points,} \hlkwd{aes}\hlstd{(}\hlkwc{x} \hlstd{= x,} \hlkwc{y} \hlstd{= y),}
             \hlkwc{color} \hlstd{=} \hlstr{"black"}\hlstd{,} \hlkwc{size} \hlstd{=} \hlnum{2.5}\hlstd{,} \hlkwc{shape} \hlstd{=} \hlnum{21}\hlstd{,} \hlkwc{fill} \hlstd{=} \hlstr{"yellow"}\hlstd{,} \hlkwc{stroke} \hlstd{=} \hlnum{1}\hlstd{)} \hlopt{+}
  \hlkwd{scale_color_manual}\hlstd{(}\hlkwc{name} \hlstd{=} \hlstr{"Interpolation\textbackslash{}nMethod"}\hlstd{,}
                     \hlkwc{values} \hlstd{=} \hlkwd{c}\hlstd{(}\hlstr{"IDW"} \hlstd{=} \hlstr{"#0066CC"}\hlstd{,} \hlstr{"Kriging"} \hlstd{=} \hlstr{"#CC0000"}\hlstd{,} \hlstr{"TPS"} \hlstd{=} \hlstr{"#00CC66"}\hlstd{))} \hlopt{+}
  \hlkwd{labs}\hlstd{(}\hlkwc{title} \hlstd{=} \hlstr{"Method Comparison - Contours Overlay"}\hlstd{,}
       \hlkwc{subtitle} \hlstd{=} \hlstr{"Comparing three interpolation methods on the same domain"}\hlstd{,}
       \hlkwc{x} \hlstd{=} \hlstr{"X Coordinate (m)"}\hlstd{,} \hlkwc{y} \hlstd{=} \hlstr{"Y Coordinate (m)"}\hlstd{)} \hlopt{+}
  \hlkwd{theme_minimal}\hlstd{(}\hlkwc{base_size} \hlstd{=} \hlnum{11}\hlstd{)} \hlopt{+}
  \hlkwd{theme}\hlstd{(}\hlkwc{plot.title} \hlstd{=} \hlkwd{element_text}\hlstd{(}\hlkwc{face} \hlstd{=} \hlstr{"bold"}\hlstd{),}
        \hlkwc{legend.position} \hlstd{=} \hlstr{"right"}\hlstd{)} \hlopt{+}
  \hlkwd{coord_fixed}\hlstd{()}

\hlcom{# Display all plots in a 2x2 grid}
\hlkwd{grid.arrange}\hlstd{(p1, p2, p3, p4,} \hlkwc{ncol} \hlstd{=} \hlnum{2}\hlstd{)}
\end{alltt}
\end{kframe}
\includegraphics[width=\maxwidth]{figure/unnamed-chunk-1-1} 
\begin{kframe}\begin{alltt}
\hlcom{# 7. Statistical comparison}
\hlkwd{cat}\hlstd{(}\hlstr{"=== INTERPOLATION METHOD COMPARISON ===\textbackslash{}n\textbackslash{}n"}\hlstd{)}
\end{alltt}
\begin{verbatim}
## === INTERPOLATION METHOD COMPARISON ===
\end{verbatim}
\begin{alltt}
\hlkwd{cat}\hlstd{(}\hlstr{"IDW (Inverse Distance Weighting):\textbackslash{}n"}\hlstd{)}
\end{alltt}
\begin{verbatim}
## IDW (Inverse Distance Weighting):
\end{verbatim}
\begin{alltt}
\hlkwd{cat}\hlstd{(}\hlkwd{sprintf}\hlstd{(}\hlstr{"  Minimum: %.2f µg/L\textbackslash{}n"}\hlstd{,} \hlkwd{min}\hlstd{(idw_df}\hlopt{$}\hlstd{u238_idw,} \hlkwc{na.rm} \hlstd{=} \hlnum{TRUE}\hlstd{)))}
\end{alltt}
\begin{verbatim}
##   Minimum: 0.12 µg/L
\end{verbatim}
\begin{alltt}
\hlkwd{cat}\hlstd{(}\hlkwd{sprintf}\hlstd{(}\hlstr{"  Maximum: %.2f µg/L\textbackslash{}n"}\hlstd{,} \hlkwd{max}\hlstd{(idw_df}\hlopt{$}\hlstd{u238_idw,} \hlkwc{na.rm} \hlstd{=} \hlnum{TRUE}\hlstd{)))}
\end{alltt}
\begin{verbatim}
##   Maximum: 41.61 µg/L
\end{verbatim}
\begin{alltt}
\hlkwd{cat}\hlstd{(}\hlkwd{sprintf}\hlstd{(}\hlstr{"  Mean:    %.2f µg/L\textbackslash{}n"}\hlstd{,} \hlkwd{mean}\hlstd{(idw_df}\hlopt{$}\hlstd{u238_idw,} \hlkwc{na.rm} \hlstd{=} \hlnum{TRUE}\hlstd{)))}
\end{alltt}
\begin{verbatim}
##   Mean:    10.64 µg/L
\end{verbatim}
\begin{alltt}
\hlkwd{cat}\hlstd{(}\hlkwd{sprintf}\hlstd{(}\hlstr{"  Std Dev: %.2f µg/L\textbackslash{}n\textbackslash{}n"}\hlstd{,} \hlkwd{sd}\hlstd{(idw_df}\hlopt{$}\hlstd{u238_idw,} \hlkwc{na.rm} \hlstd{=} \hlnum{TRUE}\hlstd{)))}
\end{alltt}
\begin{verbatim}
##   Std Dev: 6.51 µg/L
\end{verbatim}
\begin{alltt}
\hlkwd{cat}\hlstd{(}\hlstr{"Kriging (Geostatistical):\textbackslash{}n"}\hlstd{)}
\end{alltt}
\begin{verbatim}
## Kriging (Geostatistical):
\end{verbatim}
\begin{alltt}
\hlkwd{cat}\hlstd{(}\hlkwd{sprintf}\hlstd{(}\hlstr{"  Minimum: %.2f µg/L\textbackslash{}n"}\hlstd{,} \hlkwd{min}\hlstd{(krige_df}\hlopt{$}\hlstd{u238_krige,} \hlkwc{na.rm} \hlstd{=} \hlnum{TRUE}\hlstd{)))}
\end{alltt}
\begin{verbatim}
##   Minimum: -2.54 µg/L
\end{verbatim}
\begin{alltt}
\hlkwd{cat}\hlstd{(}\hlkwd{sprintf}\hlstd{(}\hlstr{"  Maximum: %.2f µg/L\textbackslash{}n"}\hlstd{,} \hlkwd{max}\hlstd{(krige_df}\hlopt{$}\hlstd{u238_krige,} \hlkwc{na.rm} \hlstd{=} \hlnum{TRUE}\hlstd{)))}
\end{alltt}
\begin{verbatim}
##   Maximum: 41.25 µg/L
\end{verbatim}
\begin{alltt}
\hlkwd{cat}\hlstd{(}\hlkwd{sprintf}\hlstd{(}\hlstr{"  Mean:    %.2f µg/L\textbackslash{}n"}\hlstd{,} \hlkwd{mean}\hlstd{(krige_df}\hlopt{$}\hlstd{u238_krige,} \hlkwc{na.rm} \hlstd{=} \hlnum{TRUE}\hlstd{)))}
\end{alltt}
\begin{verbatim}
##   Mean:    10.42 µg/L
\end{verbatim}
\begin{alltt}
\hlkwd{cat}\hlstd{(}\hlkwd{sprintf}\hlstd{(}\hlstr{"  Std Dev: %.2f µg/L\textbackslash{}n\textbackslash{}n"}\hlstd{,} \hlkwd{sd}\hlstd{(krige_df}\hlopt{$}\hlstd{u238_krige,} \hlkwc{na.rm} \hlstd{=} \hlnum{TRUE}\hlstd{)))}
\end{alltt}
\begin{verbatim}
##   Std Dev: 9.92 µg/L
\end{verbatim}
\begin{alltt}
\hlkwd{cat}\hlstd{(}\hlstr{"Thin Plate Spline:\textbackslash{}n"}\hlstd{)}
\end{alltt}
\begin{verbatim}
## Thin Plate Spline:
\end{verbatim}
\begin{alltt}
\hlkwd{cat}\hlstd{(}\hlkwd{sprintf}\hlstd{(}\hlstr{"  Minimum: %.2f µg/L\textbackslash{}n"}\hlstd{,} \hlkwd{min}\hlstd{(tps_df}\hlopt{$}\hlstd{u238_tps,} \hlkwc{na.rm} \hlstd{=} \hlnum{TRUE}\hlstd{)))}
\end{alltt}
\begin{verbatim}
##   Minimum: -4.67 µg/L
\end{verbatim}
\begin{alltt}
\hlkwd{cat}\hlstd{(}\hlkwd{sprintf}\hlstd{(}\hlstr{"  Maximum: %.2f µg/L\textbackslash{}n"}\hlstd{,} \hlkwd{max}\hlstd{(tps_df}\hlopt{$}\hlstd{u238_tps,} \hlkwc{na.rm} \hlstd{=} \hlnum{TRUE}\hlstd{)))}
\end{alltt}
\begin{verbatim}
##   Maximum: 43.09 µg/L
\end{verbatim}
\begin{alltt}
\hlkwd{cat}\hlstd{(}\hlkwd{sprintf}\hlstd{(}\hlstr{"  Mean:    %.2f µg/L\textbackslash{}n"}\hlstd{,} \hlkwd{mean}\hlstd{(tps_df}\hlopt{$}\hlstd{u238_tps,} \hlkwc{na.rm} \hlstd{=} \hlnum{TRUE}\hlstd{)))}
\end{alltt}
\begin{verbatim}
##   Mean:    10.82 µg/L
\end{verbatim}
\begin{alltt}
\hlkwd{cat}\hlstd{(}\hlkwd{sprintf}\hlstd{(}\hlstr{"  Std Dev: %.2f µg/L\textbackslash{}n\textbackslash{}n"}\hlstd{,} \hlkwd{sd}\hlstd{(tps_df}\hlopt{$}\hlstd{u238_tps,} \hlkwc{na.rm} \hlstd{=} \hlnum{TRUE}\hlstd{)))}
\end{alltt}
\begin{verbatim}
##   Std Dev: 11.98 µg/L
\end{verbatim}
\begin{alltt}
\hlcom{# Calculate area exceeding MCL}
\hlstd{idw_exceed} \hlkwb{<-} \hlkwd{sum}\hlstd{(idw_df}\hlopt{$}\hlstd{u238_idw} \hlopt{>} \hlstd{mcl_u238,} \hlkwc{na.rm} \hlstd{=} \hlnum{TRUE}\hlstd{)} \hlopt{/} \hlkwd{nrow}\hlstd{(idw_df)} \hlopt{*} \hlnum{100}
\hlstd{krige_exceed} \hlkwb{<-} \hlkwd{sum}\hlstd{(krige_df}\hlopt{$}\hlstd{u238_krige} \hlopt{>} \hlstd{mcl_u238,} \hlkwc{na.rm} \hlstd{=} \hlnum{TRUE}\hlstd{)} \hlopt{/} \hlkwd{nrow}\hlstd{(krige_df)} \hlopt{*} \hlnum{100}
\hlstd{tps_exceed} \hlkwb{<-} \hlkwd{sum}\hlstd{(tps_df}\hlopt{$}\hlstd{u238_tps} \hlopt{>} \hlstd{mcl_u238,} \hlkwc{na.rm} \hlstd{=} \hlnum{TRUE}\hlstd{)} \hlopt{/} \hlkwd{nrow}\hlstd{(tps_df)} \hlopt{*} \hlnum{100}

\hlkwd{cat}\hlstd{(}\hlstr{"Area Exceeding MCL (30 µg/L):\textbackslash{}n"}\hlstd{)}
\end{alltt}
\begin{verbatim}
## Area Exceeding MCL (30 µg/L):
\end{verbatim}
\begin{alltt}
\hlkwd{cat}\hlstd{(}\hlkwd{sprintf}\hlstd{(}\hlstr{"  IDW:     %.1f%% of study area\textbackslash{}n"}\hlstd{, idw_exceed))}
\end{alltt}
\begin{verbatim}
##   IDW:     1.0% of study area
\end{verbatim}
\begin{alltt}
\hlkwd{cat}\hlstd{(}\hlkwd{sprintf}\hlstd{(}\hlstr{"  Kriging: %.1f%% of study area\textbackslash{}n"}\hlstd{, krige_exceed))}
\end{alltt}
\begin{verbatim}
##   Kriging: 4.0% of study area
\end{verbatim}
\begin{alltt}
\hlkwd{cat}\hlstd{(}\hlkwd{sprintf}\hlstd{(}\hlstr{"  TPS:     %.1f%% of study area\textbackslash{}n\textbackslash{}n"}\hlstd{, tps_exceed))}
\end{alltt}
\begin{verbatim}
##   TPS:     9.7% of study area
\end{verbatim}
\begin{alltt}
\hlkwd{cat}\hlstd{(}\hlstr{"Script completed successfully!\textbackslash{}n"}\hlstd{)}
\end{alltt}
\begin{verbatim}
## Script completed successfully!
\end{verbatim}
\begin{alltt}
\hlkwd{cat}\hlstd{(}\hlstr{"Note: To save plots, uncomment the ggsave() line at the end of the script.\textbackslash{}n"}\hlstd{)}
\end{alltt}
\begin{verbatim}
## Note: To save plots, uncomment the ggsave() line at the end of the script.
\end{verbatim}
\end{kframe}
\end{knitrout}


\end{document}
